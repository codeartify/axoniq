openapi: 3.0.3
info:
  title: FitnessLab API
  description: API for FitnessLab management system
  version: 1.0.0
servers:
- url: http://localhost:8080
  description: Local development server
tags:
- name: Customers
  description: Customer management operations
- name: Products
  description: Product management operations
- name: Memberships
  description: Membership operations
- name: Product Contracts
  description: Product contract management
- name: Invoices
  description: Invoice management operations
paths:
  /api/customers:
    post:
      tags:
      - Customers
      operationId: registerCustomer
      summary: Register a new customer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterCustomerRequest'
      responses:
        '201':
          description: Customer registered successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CustomerRegistrationResponse'
    get:
      tags:
      - Customers
      operationId: getAllCustomers
      summary: Get all customers
      responses:
        '200':
          description: List of all customers
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CustomerView'
  /api/customers/{customerId}:
    get:
      tags:
      - Customers
      operationId: getCustomer
      summary: Get customer by ID
      parameters:
      - name: customerId
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Customer found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CustomerView'
        '404':
          description: Customer not found
    put:
      tags:
      - Customers
      operationId: updateCustomer
      summary: Update customer information
      parameters:
      - name: customerId
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateCustomerRequest'
      responses:
        '200':
          description: Customer updated successfully
  /api/products:
    post:
      tags:
      - Products
      operationId: createProduct
      summary: Create a new product
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateProductRequest'
      responses:
        '201':
          description: Product created successfully
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductCreationResponse'
    get:
      tags:
      - Products
      operationId: getAllProducts
      summary: Get all products
      responses:
        '200':
          description: List of all products
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProductView'
  /api/products/{productId}:
    get:
      tags:
      - Products
      operationId: getProduct
      summary: Get product by ID
      parameters:
      - name: productId
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Product found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductView'
        '404':
          description: Product not found
    put:
      tags:
      - Products
      operationId: updateProduct
      summary: Update product information
      parameters:
      - name: productId
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/UpdateProductRequest'
      responses:
        '200':
          description: Product updated successfully
  /api/products/memberships:
    get:
      tags:
      - Products
      operationId: getMembershipVariants
      summary: Get all membership variants
      responses:
        '200':
          description: List of membership variants
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/ProductVariantDto'
  /api/memberships/sign-up:
    post:
      tags:
      - Memberships
      operationId: signUp
      summary: Sign up for a membership
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MembershipSignUpRequestDto'
      responses:
        '200':
          description: Membership sign up successful
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MembershipSignUpResultDto'
  /api/product-contracts/{contractId}:
    get:
      tags:
      - Product Contracts
      operationId: getContractById
      summary: Get product contract by ID
      parameters:
      - name: contractId
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Contract found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ProductContractDetailDto'
        '404':
          description: Contract not found
  /api/product-contracts/{contractId}/pause:
    post:
      tags:
      - Product Contracts
      operationId: pauseContract
      summary: Pause a product contract
      parameters:
      - name: contractId
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PauseContractRequest'
      responses:
        '200':
          description: Contract paused successfully
  /api/product-contracts/{contractId}/resume:
    post:
      tags:
      - Product Contracts
      operationId: resumeContract
      summary: Resume a paused product contract
      parameters:
      - name: contractId
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Contract resumed successfully
  /api/invoices:
    get:
      tags:
      - Invoices
      operationId: getInvoices
      summary: Get all invoices, optionally filtered by status
      parameters:
      - name: status
        in: query
        required: false
        schema:
          type: string
          enum:
          - OPEN
          - PAID
          - OVERDUE
          - CANCELLED
      responses:
        '200':
          description: List of invoices
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/InvoiceDto'
  /api/invoices/customer/{customerId}:
    get:
      tags:
      - Invoices
      operationId: getInvoicesByCustomerId
      summary: Get all invoices for a customer
      parameters:
      - name: customerId
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: List of customer invoices
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/InvoiceDto'
  /api/invoices/{invoiceId}:
    get:
      tags:
      - Invoices
      operationId: getInvoiceById
      summary: Get invoice by ID
      parameters:
      - name: invoiceId
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Invoice found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/InvoiceDto'
        '404':
          description: Invoice not found
  /api/invoices/{invoiceId}/pay:
    post:
      tags:
      - Invoices
      operationId: markAsPaid
      summary: Mark an invoice as paid
      parameters:
      - name: invoiceId
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Invoice marked as paid
  /api/invoices/{invoiceId}/mark-overdue:
    post:
      tags:
      - Invoices
      operationId: markAsOverdue
      summary: Mark an invoice as overdue
      parameters:
      - name: invoiceId
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: Invoice marked as overdue
  /api/invoices/{invoiceId}/cancel:
    post:
      tags:
      - Invoices
      operationId: cancelInvoice
      summary: Cancel an invoice
      parameters:
      - name: invoiceId
        in: path
        required: true
        schema:
          type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CancelInvoiceRequest'
      responses:
        '200':
          description: Invoice cancelled successfully
components:
  schemas:
    RegisterCustomerRequest:
      type: object
      required:
      - salutation
      - firstName
      - lastName
      - dateOfBirth
      - address
      - email
      properties:
        salutation:
          $ref: '#/components/schemas/Salutation'
        firstName:
          type: string
        lastName:
          type: string
        dateOfBirth:
          type: string
          format: date
        address:
          $ref: '#/components/schemas/AddressDto'
        email:
          type: string
          format: email
        phoneNumber:
          type: string
          nullable: true
    Salutation:
      type: string
      enum:
      - MR
      - MS
      - MRS
      - MX
      - DR
    UpdateCustomerRequest:
      type: object
      required:
      - salutation
      - firstName
      - lastName
      - dateOfBirth
      - address
      - email
      properties:
        salutation:
          $ref: '#/components/schemas/Salutation'
        firstName:
          type: string
        lastName:
          type: string
        dateOfBirth:
          type: string
          format: date
        address:
          $ref: '#/components/schemas/AddressDto'
        email:
          type: string
          format: email
        phoneNumber:
          type: string
          nullable: true
    AddressDto:
      type: object
      required:
      - street
      - houseNumber
      - postalCode
      - city
      - country
      properties:
        street:
          type: string
        houseNumber:
          type: string
        postalCode:
          type: string
        city:
          type: string
        country:
          type: string
    CustomerRegistrationResponse:
      type: object
      properties:
        customerId:
          type: string
          nullable: true
        error:
          type: string
          nullable: true
    CustomerView:
      type: object
      required:
      - customerId
      - salutation
      - firstName
      - lastName
      - dateOfBirth
      - address
      - email
      - phoneNumber
      properties:
        customerId:
          type: string
        salutation:
          $ref: '#/components/schemas/Salutation'
        firstName:
          type: string
        lastName:
          type: string
        dateOfBirth:
          type: string
          format: date
        address:
          $ref: '#/components/schemas/AddressDto'
        email:
          type: string
        phoneNumber:
          type: string
          nullable: true
    CreateProductRequest:
      type: object
      required:
      - slug
      - name
      - productType
      - audience
      - requiresMembership
      - pricingVariant
      - behavior
      properties:
        slug:
          type: string
        name:
          type: string
        productType:
          type: string
        audience: &id001
          $ref: '#/components/schemas/Audience'
        requiresMembership:
          type: boolean
        pricingVariant:
          $ref: '#/components/schemas/PricingVariantConfig'
        behavior:
          $ref: '#/components/schemas/ProductBehaviorConfig'
        description:
          type: string
          nullable: true
        termsAndConditions:
          type: string
          nullable: true
        visibility:
          type: string
          enum:
          - PUBLIC
          - HIDDEN
          - ARCHIVED
          default: PUBLIC
        buyable:
          type: boolean
          default: true
        buyerCanCancel:
          type: boolean
          default: true
        perks:
          type: array
          nullable: true
          items:
            type: string
    UpdateProductRequest:
      type: object
      required:
      - slug
      - name
      - productType
      - audience
      - requiresMembership
      - pricingVariant
      - behavior
      properties:
        slug:
          type: string
        name:
          type: string
        productType:
          type: string
        audience: *id001
        requiresMembership:
          type: boolean
        pricingVariant:
          $ref: '#/components/schemas/PricingVariantConfig'
        behavior:
          $ref: '#/components/schemas/ProductBehaviorConfig'
        description:
          type: string
          nullable: true
        termsAndConditions:
          type: string
          nullable: true
        visibility:
          type: string
          enum:
          - PUBLIC
          - HIDDEN
          - ARCHIVED
        buyable:
          type: boolean
        buyerCanCancel:
          type: boolean
        perks:
          type: array
          nullable: true
          items:
            type: string
    Audience:
      type: string
      enum:
      - INTERNAL
      - EXTERNAL
      - BOTH
    ProductBehaviorConfig:
      type: object
      description: Behavior and business rules applied to product contracts.
      required:
      - canBePaused
      properties:
        canBePaused:
          type: boolean
          description: Whether the contract for this product can be paused.
        renewalLeadTimeDays:
          type: integer
          nullable: true
          description: Number of days before expiry when auto-renewal should be triggered
            in your own logic. Null if not time-based or not applicable.
        maxActivePerCustomer:
          type: integer
          nullable: true
          description: Maximum number of concurrently active contracts of this product
            (or group) allowed per customer. Null means no explicit limit.
        maxPurchasesPerBuyer:
          type: integer
          nullable: true
          minimum: 0
          maximum: 10
          description: Mirrors Wix Plan.maxPurchasesPerBuyer semantics. 0 = unlimited
            purchases, 1 = a customer can only purchase once, up to 10.
        numberOfSessions:
          type: integer
          nullable: true
          description: Total number of sessions associated with this product, if applicable.
    ProductCreationResponse:
      type: object
      properties:
        productId:
          type: string
          nullable: true
        error:
          type: string
          nullable: true
    ProductView:
      type: object
      properties:
        productId:
          type: string
        slug:
          type: string
        name:
          type: string
        productType:
          type: string
        audience:
          type: string
        requiresMembership:
          type: boolean
        pricingVariant:
          $ref: '#/components/schemas/PricingVariantConfig'
        behavior:
          $ref: '#/components/schemas/ProductBehaviorConfig'
        description:
          type: string
          nullable: true
        termsAndConditions:
          type: string
          nullable: true
        visibility:
          type: string
          enum:
          - PUBLIC
          - HIDDEN
          - ARCHIVED
          nullable: true
        buyable:
          type: boolean
          nullable: true
        buyerCanCancel:
          type: boolean
          nullable: true
        perks:
          type: array
          nullable: true
          items:
            type: string
        linkedPlatforms:
          type: array
          description: External platforms where this product is linked/published.
          items:
            $ref: '#/components/schemas/LinkedPlatformSync'
    ProductVariantDto:
      type: object
      required:
      - id
      - slug
      - name
      - productType
      - pricingVariant
      properties:
        id:
          type: string
        slug:
          type: string
        name:
          type: string
        productType:
          type: string
        pricingVariant:
          $ref: '#/components/schemas/PricingVariantConfig'
    MembershipSignUpRequestDto:
      type: object
      required:
      - customerId
      - productVariantId
      - paymentMode
      - startDate
      properties:
        customerId:
          type: string
        productVariantId:
          type: string
        paymentMode:
          type: string
          enum:
          - PAY_ON_SITE
          - INVOICE_EMAIL
        startDate:
          type: string
          format: date
    MembershipSignUpResultDto:
      type: object
      required:
      - contractId
      - bookingId
      - invoiceId
      - bexioInvoiceId
      properties:
        contractId:
          type: string
        bookingId:
          type: string
        invoiceId:
          type: string
        bexioInvoiceId:
          type: integer
          description: The Bexio invoice ID
    ProductContractDetailDto:
      type: object
      required:
      - contractId
      - customerId
      - productVariantId
      - bookingId
      - status
      - sessionsUsed
      - pauseHistory
      - canBePaused
      properties:
        contractId:
          type: string
        customerId:
          type: string
        productVariantId:
          type: string
        bookingId:
          type: string
        status:
          type: string
        validity:
          $ref: '#/components/schemas/DateRangeDto'
          nullable: true
        sessionsTotal:
          type: integer
          nullable: true
        sessionsUsed:
          type: integer
        pauseHistory:
          type: array
          items:
            $ref: '#/components/schemas/PauseHistoryEntryDto'
        canBePaused:
          type: boolean
    DateRangeDto:
      type: object
      required:
      - start
      - end
      properties:
        start:
          type: string
          format: date
        end:
          type: string
          format: date
    PauseHistoryEntryDto:
      type: object
      required:
      - pauseRange
      - reason
      properties:
        pauseRange:
          $ref: '#/components/schemas/DateRangeDto'
        reason:
          type: string
    PauseContractRequest:
      type: object
      required:
      - startDate
      - endDate
      - reason
      properties:
        startDate:
          type: string
          format: date
        endDate:
          type: string
          format: date
        reason:
          type: string
          enum:
          - MEDICAL
          - VACATION
          - OTHER
    InvoiceDto:
      type: object
      required:
      - invoiceId
      - customerId
      - customerName
      - bookingId
      - amount
      - dueDate
      - status
      - isInstallment
      properties:
        invoiceId:
          type: string
        customerId:
          type: string
        customerName:
          type: string
        bookingId:
          type: string
        amount:
          type: number
          format: decimal
        dueDate:
          type: string
          format: date
        status:
          type: string
        isInstallment:
          type: boolean
        installmentNumber:
          type: integer
          nullable: true
        paidAt:
          type: string
          format: date-time
          nullable: true
    CancelInvoiceRequest:
      type: object
      required:
      - reason
      properties:
        reason:
          type: string
    BillingInterval:
      type: string
      description: Unit used for billing, duration and free trial.
      enum:
      - DAY
      - WEEK
      - MONTH
      - YEAR
    PricingModel:
      type: string
      description: Pricing model, aligned with Wix Plan.pricingVariants[].pricingModel.
      enum:
      - SUBSCRIPTION
      - SINGLE_PAYMENT_FOR_DURATION
      - SINGLE_PAYMENT_UNLIMITED
    PricingDuration:
      type: object
      description: Generic duration structure used for billingCycle, duration and
        freeTrial.
      required:
      - interval
      - count
      properties:
        interval:
          $ref: '#/components/schemas/BillingInterval'
        count:
          type: integer
          minimum: 1
    PricingVariantConfig:
      type: object
      description: Pricing configuration for the product, conceptually matching Wix
        Plan.pricingVariants[0].
      required:
      - pricingModel
      - flatRate
      properties:
        pricingModel:
          $ref: '#/components/schemas/PricingModel'
        flatRate:
          type: number
          format: decimal
        billingCycle:
          $ref: '#/components/schemas/PricingDuration'
          nullable: true
        duration:
          $ref: '#/components/schemas/PricingDuration'
          nullable: true
        freeTrial:
          $ref: '#/components/schemas/PricingDuration'
          nullable: true
    LinkedPlatformSync:
      type: object
      description: Synchronization state of this product on an external platform.
      required:
      - platformName
      - isSynced
      properties:
        platformName:
          type: string
          description: Name of the external platform (e.g. "wix", "shopify", "webflow").
          example: wix
        idOnPlatform:
          type: string
          nullable: true
          description: Identifier of the product/plan on the external platform. Null
            if it has not been created there yet.
        revision:
          type: string
          nullable: true
          description: Revision or version identifier as used by the platform (e.g.
            Wix plan.revision).
        visibilityOnPlatform:
          type: string
          nullable: true
          description: Visibility/status of the product on that platform.
          enum:
          - DRAFT
          - PUBLISHED
          - ARCHIVED
          - HIDDEN
          - NOT_PUBLISHED
        isSynced:
          type: boolean
          description: True if the last local change has been successfully pushed
            to this platform.
        isSourceOfTruth:
          type: boolean
          default: false
          description: If true, this platform is considered the authoritative source
            for product data; sync direction is primarily platform -> local.
        lastSyncedAt:
          type: string
          format: date-time
          nullable: true
          description: Timestamp of the last successful sync to this platform.
        syncError:
          type: string
          nullable: true
          description: Last error message when attempting to sync with this platform,
            if any.
